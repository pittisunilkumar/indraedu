(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{VDjS:function(t,e,a){"use strict";a.r(e),a.d(e,"DeparmentModule",function(){return X});var n=a("ofXK"),r=a("sYmb"),i=a("3Pt+"),c=a("tyNb"),o=a("HYn3"),l=a("LavL"),s=a("mrSG"),m=a("7Cbv"),d=a("fXoL"),p=a("Wp6s"),u=a("A/5o"),h=a("kmnG"),b=a("qFsG"),f=a("d3UM"),g=a("bSwM"),D=a("bTqV"),v=a("FKr1");function y(t,e){1&t&&(d.bc(0,"h2"),d.bc(1,"span",13),d.Qc(2,"Create\xa0Event"),d.ac(),d.ac())}function C(t,e){1&t&&(d.bc(0,"h2"),d.bc(1,"span",13),d.Qc(2,"Edit\xa0Event"),d.ac(),d.ac())}function O(t,e){if(1&t&&(d.bc(0,"mat-option",20),d.Qc(1),d.ac()),2&t){const t=e.$implicit;d.tc("value",t),d.Kb(1),d.Sc(" ",t.name,"")}}function P(t,e){if(1&t){const t=d.cc();d.bc(0,"mat-option",21,22),d.ic("click",function(){d.Fc(t);const a=e.$implicit,n=d.Cc(1);return d.mc().insertAndDeleteArray(n._selected,a._id)}),d.Qc(2),d.ac()}if(2&t){const t=e.$implicit;d.tc("value",t),d.Kb(2),d.Sc(" ",t.name,"")}}function w(t,e){if(1&t){const t=d.cc();d.bc(0,"button",23),d.ic("click",function(){return d.Fc(t),d.mc().resetForm()}),d.Qc(1," Reset "),d.ac()}}let M=(()=>{class t{constructor(t,e,a,n,r,i){this.formBuilder=t,this.helper=e,this.route=a,this.departmentsService=n,this.router=r,this.employeeService=i,this.mode=this.route.snapshot.data.mode,this.insertDepartmentArray=[],this.deleteDepartmentArray=[]}ngOnInit(){var t;return Object(s.a)(this,void 0,void 0,function*(){if(this.createDepartmentForm=this.buildForm(),"edit"===this.mode){let e,a=this.route.snapshot.paramMap.get("uuid");e=yield this.departmentsService.getDepartmentByUuid(a).toPromise(),this.department=e.response,this.insertDepartmentArray=null===(t=this.department)||void 0===t?void 0:t.hod.map(t=>null==t?void 0:t._id),this.createDepartmentForm=this.buildForm()}this.getEmployees()})}buildForm(){var t,e,a,n;return this.formBuilder.group({title:[this.department?null===(t=this.department)||void 0===t?void 0:t.title:"",i.v.required],employee:[this.department?null===(e=this.department)||void 0===e?void 0:e.employee:"",i.v.required],hod:[this.department?null===(a=this.department)||void 0===a?void 0:a.hod:"",i.v.required],flags:this.formBuilder.group({active:!this.department||(null===(n=this.department)||void 0===n?void 0:n.flags.active)})})}getEmployees(){this.employeeService.getAllEmployees().subscribe(t=>{this.employeeList=null==t?void 0:t.response})}insertAndDeleteArray(t,e){1==t?(this.insertDepartmentArray=this.insertDepartmentArray.filter(t=>t!=e),this.deleteDepartmentArray=this.deleteDepartmentArray.filter(t=>t!=e),this.insertDepartmentArray.push(e)):0==t&&(this.deleteDepartmentArray=this.deleteDepartmentArray.filter(t=>t!=e),this.insertDepartmentArray=this.insertDepartmentArray.filter(t=>t!=e),this.deleteDepartmentArray.push(e)),console.log("deleteDepartmentArray",this.deleteDepartmentArray),console.log("insertDepartmentArray",this.insertDepartmentArray)}submit(){var t,e,a,n;const r=this.createDepartmentForm.value;if("add"===this.mode){const t={uuid:m.a(),title:r.title,employee:r.employee.map(t=>t._id),hod:r.hod.map(t=>t._id),createdOn:new Date,createdBy:{uuid:localStorage.getItem("currentUserUuid"),name:localStorage.getItem("currentUserName")},flags:{active:r.flags.active}};console.log(t),this.departmentsService.addDepartment(t).subscribe(t=>{t&&this.router.navigate(["/manage/department/list"])})}else{this.insertDepartmentArray.map(t=>{this.department.hod.map(e=>{e._id==t&&(this.insertDepartmentArray=this.insertDepartmentArray.filter(t=>e._id!=t))})}),this.deleteDepartmentArray.map(t=>{this.department.hod.map(e=>{e._id!=t&&(this.deleteDepartmentArray=this.deleteDepartmentArray.filter(a=>e._id!=t))})});const i={_id:null===(t=this.department)||void 0===t?void 0:t._id,uuid:null===(e=this.department)||void 0===e?void 0:e.uuid,title:r.title,employee:r.employee,hod:r.hod,insertDepartmentArray:this.insertDepartmentArray,deleteDepartmentArray:this.deleteDepartmentArray,createdBy:null===(a=this.department)||void 0===a?void 0:a.createdBy,createdOn:null===(n=this.department)||void 0===n?void 0:n.createdOn,modifiedOn:new Date,modifiedBy:{uuid:localStorage.getItem("currentUserUuid"),name:localStorage.getItem("currentUserName")},flags:{active:r.flags.active}};console.log(i),this.departmentsService.editDepartmentByUuid(i).subscribe(t=>{t&&this.router.navigate(["/manage/department/list"])})}}resetForm(){this.createDepartmentForm.reset()}}return t.\u0275fac=function(e){return new(e||t)(d.Vb(i.e),d.Vb(o.P),d.Vb(c.a),d.Vb(o.E),d.Vb(c.f),d.Vb(o.L))},t.\u0275cmp=d.Pb({type:t,selectors:[["application-create-department"]],decls:41,vars:13,consts:[[1,"create-tags"],[4,"ngIf"],[3,"formGroup"],[1,"flex-wrap"],[1,"form-element","child"],[1,"example-form-field"],["matInput","","name","title","formControlName","title"],[1,"example-full-width"],["formControlName","employee","multiple","",3,"compareWith"],[3,"value",4,"ngFor","ngForOf"],["formControlName","hod","multiple","",3,"compareWith"],[3,"value","click",4,"ngFor","ngForOf"],[1,"form-element","child","flags",3,"formGroup"],["translate",""],["for","isActive"],["name","active","formControlName","active",1,"example-margin"],[1,"text-right","button-group"],["mat-stroked-button","","color","warn","translate","",3,"click",4,"ngIf"],["routerLink","/manage/events/list","mat-raised-button","","color","warn","translate",""],["mat-raised-button","","color","primary","type","submit","translate","",3,"disabled","click"],[3,"value"],[3,"value","click"],["EVENT",""],["mat-stroked-button","","color","warn","translate","",3,"click"]],template:function(t,e){1&t&&(d.bc(0,"div",0),d.Pc(1,y,3,0,"h2",1),d.Pc(2,C,3,0,"h2",1),d.bc(3,"mat-card"),d.bc(4,"form",2),d.bc(5,"div",3),d.bc(6,"div",4),d.bc(7,"mat-form-field",5),d.bc(8,"mat-label"),d.Qc(9,"Department Title\xa0"),d.bc(10,"sup"),d.Qc(11,"*"),d.ac(),d.ac(),d.Wb(12,"input",6),d.ac(),d.ac(),d.bc(13,"div",4),d.bc(14,"mat-form-field",7),d.bc(15,"mat-label"),d.Qc(16,"Employees"),d.ac(),d.bc(17,"mat-select",8),d.Pc(18,O,2,2,"mat-option",9),d.ac(),d.ac(),d.ac(),d.bc(19,"div",4),d.bc(20,"mat-form-field",7),d.bc(21,"mat-label"),d.Qc(22,"Head\xa0Of\xa0Department"),d.ac(),d.bc(23,"mat-select",10),d.Pc(24,P,3,2,"mat-option",11),d.ac(),d.ac(),d.ac(),d.ac(),d.bc(25,"div",12),d.bc(26,"strong"),d.bc(27,"span",13),d.Qc(28,"COMMON.FLAGS"),d.ac(),d.ac(),d.bc(29,"div",3),d.bc(30,"div",4),d.bc(31,"label",14),d.bc(32,"mat-checkbox",15),d.Qc(33),d.nc(34,"translate"),d.ac(),d.ac(),d.ac(),d.ac(),d.ac(),d.bc(35,"div",16),d.Pc(36,w,2,0,"button",17),d.bc(37,"button",18),d.Qc(38," Cancel "),d.ac(),d.bc(39,"button",19),d.ic("click",function(){return e.submit()}),d.Qc(40," Submit "),d.ac(),d.ac(),d.ac(),d.ac(),d.ac()),2&t&&(d.Kb(1),d.tc("ngIf","add"===e.mode),d.Kb(1),d.tc("ngIf","edit"===e.mode),d.Kb(2),d.tc("formGroup",e.createDepartmentForm),d.Kb(13),d.tc("compareWith",e.helper.compareFn),d.Kb(1),d.tc("ngForOf",e.employeeList),d.Kb(5),d.tc("compareWith",e.helper.compareFn),d.Kb(1),d.tc("ngForOf",null==e.createDepartmentForm||null==e.createDepartmentForm.value?null:e.createDepartmentForm.value.employee),d.Kb(1),d.tc("formGroup",null==e.createDepartmentForm||null==e.createDepartmentForm.controls?null:e.createDepartmentForm.controls.flags),d.Kb(8),d.Rc(d.oc(34,11,"COMMON.ACTIVE")),d.Kb(3),d.tc("ngIf","add"===e.mode),d.Kb(3),d.tc("disabled",!e.createDepartmentForm.valid))},directives:[n.o,p.a,i.x,i.q,u.a,i.i,h.b,h.e,b.b,i.c,i.p,i.g,f.a,n.n,r.a,g.a,D.a,c.g,v.m],pipes:[r.d],styles:[".flags[_ngcontent-%COMP%]{flex:0 1 auto}.form-element[_ngcontent-%COMP%]{flex-grow:2;margin-right:1rem}.form-element[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%]{width:100%}.confirm-step.flex-wrap[_ngcontent-%COMP%]   .review[_ngcontent-%COMP%]{width:33.33%}.confirm-step.flex-wrap[_ngcontent-%COMP%]   .w-1-1[_ngcontent-%COMP%]{width:100%}.spacer[_ngcontent-%COMP%]{flex:8 auto}"]}),t})();var A=a("M9IT"),_=a("Dh3D"),F=a("+0xr"),S=a("w4Ql"),x=a("quSY"),I=a("0IaG"),K=a("STbY");const Q=function(){return["../","create"]};function E(t,e){1&t&&(d.bc(0,"button",23),d.Qc(1,"Create Department"),d.ac()),2&t&&d.tc("routerLink",d.yc(1,Q))}function k(t,e){1&t&&(d.bc(0,"th",24),d.Qc(1," S.No "),d.ac())}function L(t,e){if(1&t&&(d.bc(0,"td",25),d.Qc(1),d.ac()),2&t){const t=e.$implicit,a=d.mc();d.Kb(1),d.Rc(a.filteredDepartments.filteredData.indexOf(t)+1)}}function T(t,e){1&t&&(d.bc(0,"th",26),d.Qc(1),d.nc(2,"translate"),d.ac()),2&t&&(d.Kb(1),d.Sc(" ",d.oc(2,1,"COMMON.TITLE")," "))}function N(t,e){if(1&t&&(d.bc(0,"td",25),d.Qc(1),d.ac()),2&t){const t=e.$implicit;d.Kb(1),d.Rc(t.title)}}function V(t,e){1&t&&(d.bc(0,"th",26),d.Qc(1," Head\xa0Of\xa0Department "),d.ac())}function R(t,e){if(1&t&&(d.bc(0,"div"),d.bc(1,"span"),d.Qc(2),d.ac(),d.ac()),2&t){const t=e.$implicit,a=e.index,n=d.mc().$implicit;d.Kb(2),d.Tc("",t.name," ",(null==n?null:n.hod.length)!=a+1?",":""," ")}}function B(t,e){if(1&t&&(d.bc(0,"td",25),d.Pc(1,R,3,2,"div",27),d.ac()),2&t){const t=e.$implicit;d.Kb(1),d.tc("ngForOf",null==t?null:t.hod)}}function G(t,e){1&t&&(d.bc(0,"th",26),d.Qc(1),d.nc(2,"translate"),d.ac()),2&t&&(d.Kb(1),d.Sc(" ",d.oc(2,1,"COMMON.ACTIVE")," "))}function $(t,e){if(1&t&&(d.bc(0,"td",25),d.Qc(1),d.ac()),2&t){const t=e.$implicit;d.Kb(1),d.Rc(t.flags.active)}}function U(t,e){1&t&&(d.bc(0,"th",26),d.Qc(1),d.nc(2,"translate"),d.ac()),2&t&&(d.Kb(1),d.Sc(" ",d.oc(2,1,"COMMON.ACTIONS.TITLE")," "))}const H=function(t){return["../",t,"edit"]};function W(t,e){if(1&t&&(d.bc(0,"a",32),d.bc(1,"button",33),d.Qc(2," Edit\xa0Department "),d.ac(),d.ac()),2&t){const t=d.mc().$implicit;d.tc("routerLink",d.zc(1,H,t.uuid))}}function Y(t,e){if(1&t){const t=d.cc();d.bc(0,"button",34),d.ic("click",function(){d.Fc(t);const e=d.mc().$implicit;return d.mc().delete(e)}),d.Qc(1," Delete\xa0Department "),d.ac()}}function q(t,e){if(1&t&&(d.bc(0,"td",25),d.bc(1,"i",28),d.Qc(2,"more_vert"),d.ac(),d.bc(3,"mat-menu",null,29),d.Pc(5,W,3,3,"a",30),d.Pc(6,Y,2,0,"button",31),d.ac(),d.ac()),2&t){const t=d.Cc(4),e=d.mc();d.Kb(1),d.tc("matMenuTriggerFor",t),d.Kb(4),d.tc("ngIf",e.isEditVisible),d.Kb(1),d.tc("ngIf",e.isDeleteVisible)}}function j(t,e){1&t&&d.Wb(0,"tr",35)}function z(t,e){1&t&&d.Wb(0,"tr",36)}function Z(t,e){1&t&&(d.bc(0,"tr",37),d.bc(1,"td",38),d.bc(2,"h3",7),d.Qc(3,"COMMON.NO_DATA"),d.ac(),d.ac(),d.ac())}const J=[{path:"",children:[{path:"create",canActivate:[o.y],component:M,data:{mode:"add"}},{path:":uuid/edit",canActivate:[o.G],component:M,data:{mode:"edit"}},{path:"list",component:(()=>{class t{constructor(t,e,a,n){this.departmentsService=t,this.dialog=e,this.helper=a,this.router=n,this.totalLength=[10,25,50,100],this.sub=new x.a,this.displayedColumns=["sno","title","hod","status","actions"],this.today=new Date}loadData(){this.departmentsService.getAllDepartments().subscribe(t=>{this.departments=this.filteredDepartments=null==t?void 0:t.response,this.filteredDepartments=new F.l(this.filteredDepartments),this.filteredDepartments.paginator=this.paginator,this.filteredDepartments.sort=this.sort})}ngOnInit(){this.loadPermissions(),this.loadData()}delete(t){this.dialog.open(o.q,{data:{payload:t}}).afterClosed().subscribe(e=>{e&&this.sub.add(this.departmentsService.deleteEventByUuid(t._id).subscribe(t=>{this.loadData()},t=>{this.errors=t.error.error}))})}filterDepartments(t){const e=t.target.value.toLowerCase().trim();this.filteredDepartments=e?this.departments.filter(t=>t.title.toLowerCase().includes(e)):this.departments,this.filteredDepartments=new F.l(this.filteredDepartments),this.filteredDepartments.paginator=this.paginator,this.filteredDepartments.sort=this.sort}loadPermissions(){let t=this.helper.enumtoArray(S.d),e=this.helper.enumtoArray(S.e),a=localStorage.getItem("role"),n=JSON.parse(localStorage.getItem("roleData"));a&&n[0].rolePermissions.map(a=>{a.module[0].title===t.type.DEPARTMENT&&a.subModules.map(t=>{t.title==e.type.ADD?this.isAddVisible=!0:t.title==e.type.DELETE?this.isDeleteVisible=!0:t.title==e.type.EDIT&&(this.isEditVisible=!0)})})}}return t.\u0275fac=function(e){return new(e||t)(d.Vb(o.E),d.Vb(I.c),d.Vb(o.P),d.Vb(c.f))},t.\u0275cmp=d.Pb({type:t,selectors:[["application-department-list"]],viewQuery:function(t,e){if(1&t&&(d.Lc(_.a,!0),d.Lc(A.a,!0)),2&t){let t;d.Bc(t=d.jc())&&(e.sort=t.first),d.Bc(t=d.jc())&&(e.paginator=t.first)}},decls:34,vars:9,consts:[[1,"tag-list"],[1,"page-title"],[1,"title"],[1,"action-buttons"],["mat-raised-button","","color","primary",3,"routerLink",4,"ngIf"],[1,"search","full-width"],[1,"example-full-width"],["translate",""],["type","search","matInput","","name","search",3,"placeholder","keyup"],[1,"mat-elevation-z1"],["mat-table","",3,"dataSource"],["matColumnDef","sno"],["mat-header-cell","","style","width: 20px;",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","title"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","hod"],["matColumnDef","status"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row","style","text-align: center;",4,"matNoDataRow"],[3,"showFirstLastButtons","pageSizeOptions"],["mat-raised-button","","color","primary",3,"routerLink"],["mat-header-cell","",2,"width","20px"],["mat-cell",""],["mat-header-cell",""],[4,"ngFor","ngForOf"],[1,"material-icons",2,"margin-left","10px",3,"matMenuTriggerFor"],["menu","matMenu"],["style","text-decoration: none;",3,"routerLink",4,"ngIf"],["mat-menu-item","",3,"click",4,"ngIf"],[2,"text-decoration","none",3,"routerLink"],["mat-menu-item","","color","primary"],["mat-menu-item","",3,"click"],["mat-header-row",""],["mat-row",""],[1,"mat-row",2,"text-align","center"],["colspan","5",1,"mat-cell"]],template:function(t,e){1&t&&(d.bc(0,"div",0),d.bc(1,"div",1),d.bc(2,"div",2),d.bc(3,"h2"),d.Qc(4,"Departments"),d.ac(),d.ac(),d.bc(5,"div",3),d.Pc(6,E,2,2,"button",4),d.ac(),d.ac(),d.bc(7,"div",5),d.bc(8,"mat-form-field",6),d.bc(9,"mat-label",7),d.Qc(10,"COMMON.SEARCH"),d.ac(),d.bc(11,"input",8),d.ic("keyup",function(t){return e.filterDepartments(t)}),d.nc(12,"translate"),d.ac(),d.ac(),d.ac(),d.bc(13,"div",9),d.bc(14,"table",10),d.Zb(15,11),d.Pc(16,k,2,0,"th",12),d.Pc(17,L,2,1,"td",13),d.Yb(),d.Zb(18,14),d.Pc(19,T,3,3,"th",15),d.Pc(20,N,2,1,"td",13),d.Yb(),d.Zb(21,16),d.Pc(22,V,2,0,"th",15),d.Pc(23,B,2,1,"td",13),d.Yb(),d.Zb(24,17),d.Pc(25,G,3,3,"th",15),d.Pc(26,$,2,1,"td",13),d.Yb(),d.Zb(27,18),d.Pc(28,U,3,3,"th",15),d.Pc(29,q,7,3,"td",13),d.Yb(),d.Pc(30,j,1,0,"tr",19),d.Pc(31,z,1,0,"tr",20),d.Pc(32,Z,4,0,"tr",21),d.ac(),d.Wb(33,"mat-paginator",22),d.ac(),d.ac()),2&t&&(d.Kb(6),d.tc("ngIf",e.isAddVisible),d.Kb(5),d.tc("placeholder",d.oc(12,7,"PAGE.ORGANIZATION_LIST.SEARCH")),d.Kb(3),d.tc("dataSource",e.filteredDepartments),d.Kb(16),d.tc("matHeaderRowDef",e.displayedColumns),d.Kb(1),d.tc("matRowDefColumns",e.displayedColumns),d.Kb(2),d.tc("showFirstLastButtons",!0)("pageSizeOptions",e.totalLength))},directives:[n.o,h.b,h.e,r.a,b.b,F.k,F.c,F.e,F.b,F.g,F.j,F.h,A.a,D.a,c.g,F.d,F.a,n.n,K.d,K.a,c.i,K.b,F.f,F.i],pipes:[r.d],styles:[".material-icons[_ngcontent-%COMP%]{cursor:pointer;margin:2px;border:1px solid #e7e6e6;border-radius:7px;padding:1px}.tag-list[_ngcontent-%COMP%]{margin:1rem 0}.tag-list[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%}.tag-list[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%]{font-size:1rem;width:100%}.tag-list[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .tag-list[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:1rem;text-align:center}.tag-list[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .img-wrap[_ngcontent-%COMP%], .tag-list[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .img-wrap[_ngcontent-%COMP%]{width:100%}.tag-list[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .img-wrap[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .tag-list[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .img-wrap[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100px;max-height:100px}"]}),t})()},{path:"",outlet:"aside",component:l.a},{path:"",pathMatch:"full",redirectTo:"/manage/department/list"}]}];let X=(()=>{class t{}return t.\u0275mod=d.Tb({type:t}),t.\u0275inj=d.Sb({factory:function(e){return new(e||t)},imports:[[n.c,r.c,i.u,c.j.forChild(J),o.zb]]}),t})()}}]);